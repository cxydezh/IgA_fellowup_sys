# 数据库更新说明

## 新增字段

在随访记录（FollowupRecord）表中新增了两个字段：

1. **urine_protein_24h** - 24小时尿蛋白 (g/24h)
   - 类型：Float
   - 单位：g/24h
   - 说明：记录患者24小时尿蛋白定量

2. **urine_protein_creatinine_ratio** - 尿蛋白肌酐比 (mg/g)
   - 类型：Float
   - 单位：mg/g
   - 说明：记录尿蛋白肌酐比值

## 数据库更新方法

### 方法1：自动更新（推荐）
如果数据库尚未创建，直接运行应用即可，新字段会自动创建。

### 方法2：手动更新（如果数据库已存在）
如果数据库已经存在，需要手动添加新字段：

```sql
-- 连接到SQLite数据库
sqlite3 iga_followup.db

-- 添加24小时尿蛋白字段
ALTER TABLE followup_records ADD COLUMN urine_protein_24h REAL;

-- 添加尿蛋白肌酐比字段
ALTER TABLE followup_records ADD COLUMN urine_protein_creatinine_ratio REAL;

-- 退出
.quit
```

### 方法3：重新创建数据库（如果数据不重要）
如果数据库中的数据不重要，可以删除数据库文件，然后重新运行应用：

```bash
# 删除数据库文件
rm iga_followup.db

# 重新运行应用
python app.py
```

## 功能更新

### 1. 随访记录表单
- 在"实验室检查"部分添加了两个新的输入框
- 24小时尿蛋白：数字输入，单位g/24h
- 尿蛋白肌酐比：数字输入，单位mg/g

### 2. 随访记录详情页
- 在"实验室检查"部分显示这两个新字段
- 自动显示单位（g/24h 和 mg/g）

### 3. 数据保存
- 添加和编辑随访记录时，可以输入这两个新字段的值
- 字段为可选，可以为空

## 注意事项

1. 如果数据库已存在且包含数据，建议使用方法2手动添加字段
2. 新字段为可选字段，不会影响现有数据
3. 如果重新创建数据库，所有现有数据将丢失




